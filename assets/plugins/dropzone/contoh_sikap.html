
<!DOCTYPE html>
<!--
Template Name: Frest HTML Admin Template
Author: :Pixinvent
Website: http://www.pixinvent.com/
Contact: hello@pixinvent.com
Follow: www.twitter.com/pixinvents
Like: www.facebook.com/pixinvents
Purchase: https://1.envato.market/pixinvent_portfolio
Renew Support: https://1.envato.market/pixinvent_portfolio
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.

-->
<html class="loading" lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Frest admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords" content="admin template, Frest admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <meta name="url" content="https://appt.demoo.id/peruri_sikkap/" />
    <meta name="access_token" content="">
    <meta name="pegawai_id" content="">
    <meta name="jabatan_id" content="">
    <meta name="bulan_SESS" content="">
    <meta name="tahun_SESS" content="">
    <title>PERURI | Home</title>
    <link rel="apple-touch-icon" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/logo-header.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://appt.demoo.id/peruri_sikkap/assets/images/logo.ico">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600%7CIBM+Plex+Sans:300,400,500,600,700" rel="stylesheet">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/ui/prism.min.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/tables/datatable/datatables.min.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/extensions/sweetalert2.min.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/plugins/extensions/toastr.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/pickers/pickadate/pickadate.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/pickers/daterange/daterangepicker.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/forms/select/select2.min.css">
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/components.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/themes/dark-layout.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/themes/semi-dark-layout.css">

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/core/menu/menu-types/horizontal-menu.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/pages/dashboard-ecommerce.css">
    <!-- END: Page CSS-->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css">

    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/vendors-rtl.min.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/pickers/pickadate/pickadate.css">
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/pickers/daterange/daterangepicker.css">

    
    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/assets/css/style.css">
    <style>
        .dropzone.dz-clickable {
            text-align: center;
        }

        .select2-container--default .select2-results>.select2-results__options {
            max-height: 400px;
        }

        .horizontal-menu .header-navbar.navbar-brand-center .navbar-header .navbar-brand .brand-logo{
            background: url('https://appt.demoo.id/peruri_sikkap/assets/images/logo-peruri-text.png') no-repeat;
            background-size: cover;
            height: 60px;
            width: 220px;
            margin-right: -20px;
        }
    </style>
    <!-- END: Custom CSS-->

</head>
<!-- END: Head-->

<body class="horizontal-layout horizontal-menu navbar-sticky 2-columns  navbar-sticky footer-static  " data-open="hover" data-menu="horizontal-menu" data-col="2-columns">

    <!-- BEGIN: Header-->
    <nav class="header-navbar navbar-expand-lg navbar navbar-with-menu fixed-top bg-primary navbar-brand-center">
        <div class="navbar-header d-xl-block d-none">
            <ul class="nav navbar-nav flex-row">
                <li class="nav-item"><a class="navbar-brand" href="">
                        <div class="brand-logo"></div>
                        <!-- <h2 class="brand-text mb-0">APLIKASI ANAK PERUSAHAAN</h2> -->
                    </a></li>
            </ul>
        </div>
        <div class="navbar-wrapper">
            <div class="navbar-container content">
                <div class="navbar-collapse" id="navbar-mobile">
                    <div class="mr-auto float-left bookmark-wrapper d-flex align-items-center">
                        <ul class="nav navbar-nav">
                            <li class="nav-item mobile-menu mr-auto"><a class="nav-link nav-menu-main menu-toggle" href="#"><i class="bx bx-menu"></i></a></li>
                        </ul>
                    </div>
                    <ul class="nav navbar-nav float-right d-flex align-items-center">
                        <li class="dropdown dropdown-language nav-item" style="margin-right: 5px;">
                            <select name="periode_tahun" id="periode_tahun" class="form-control" style="width: 100px;">
                                <option value="2022" >2022</option>
                                <option value="2021" Selected>2021</option>
                                <option value="2020" >2020</option>
                            </select>
                        </li>
                        <li class="dropdown dropdown-language nav-item" style="margin-right: 5px;">
                            <select name="periode_bulan" id="periode_bulan" class="form-control" style="width: 100px;">
                                <option value="" selected disabled></option>
                                <option value="01" >Januari</option>
                                <option value="02" >Februari</option>
                                <option value="03" >Maret</option>
                                <option value="04" >April</option>
                                <option value="05" >Mei</option>
                                <option value="06" >Juni</option>
                                <option value="07" >Juli</option>
                                <option value="08" >Agustus</option>
                                <option value="09" >September</option>
                                <option value="10" >Oktober</option>
                                <option value="11" >November</option>
                                <option value="12" Selected>Desember</option>
                                
                                <!-- <option value="12" Selected>Januari</option>
                                <option value="01" >Februari</option>
                                <option value="03" >Maret</option>
                                <option value="03" >April</option>
                                <option value="04" >Mei</option>
                                <option value="05" >Juni</option>
                                <option value="06" >Juli</option>
                                <option value="07" >Agustus</option>
                                <option value="08" >September</option>
                                <option value="09" >Oktober</option>
                                <option value="10" >November</option>
                                <option value="11" >Desember</option> -->
                            </select>
                        </li>
                        <li class="dropdown dropdown-user nav-item"><a class="dropdown-toggle nav-link dropdown-user-link" href="#" data-toggle="dropdown">
                                <div class="user-nav d-sm-flex d-none">
                                    <span class="user-name"></span>
                                    <span class="user-status">
                                    Anak Baru                                    </span>
                                </div>
                                <span>
                                                                            <img class="round" src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/images/portrait/small/avatar-s-11.jpg" alt="avatar" height="40" width="40">
                                                                    </span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right">
                                                                <a href="https://appt.demoo.id/peruri_sikkap/login/profil" class="dropdown-item"><i class="bx bx-user mr-50"></i> Profil</a>
                                                                <button type="button" class="dropdown-item" onclick="showModalPassword()"><i class="bx bx-lock-alt mr-50"></i> Ubah Password</button>
                                <div class="dropdown-divider"></div><a class="dropdown-item" href="https://appt.demoo.id/peruri_sikkap/login/keluar"><i class="bx bx-power-off mr-50"></i> Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <!-- END: Header-->    <!-- BEGIN: Main Menu-->
    <div class="header-navbar navbar-expand-sm navbar navbar-horizontal navbar-fixed navbar-light navbar-without-dd-arrow" role="navigation" data-menu="menu-wrapper">
        <!-- <div class="navbar-header d-xl-none d-block">
            <ul class="nav navbar-nav flex-row">
                <li class="nav-item mr-auto"><a class="navbar-brand" href="#">
                        <div class="brand-logo"></div>
                        <h2 class="brand-text mb-0">SIAKTIP</h2>
                    </a></li>
                <li class="nav-item nav-toggle"><a class="nav-link modern-nav-toggle pr-0" data-toggle="collapse"><i class="bx bx-x d-block d-xl-none font-medium-4 primary toggle-icon"></i></a></li>
            </ul>
        </div> -->
        <div class="shadow-bottom"></div>
        <!-- Horizontal menu content-->
        <div class="navbar-container main-menu-content" data-menu="menu-container">
            <!-- include ../../../includes/mixins-->
            <ul class="nav navbar-nav" id="main-menu-navigation" data-menu="menu-navigation">
                                                    <li class=" nav-item"><a class="nav-link" href="https://appt.demoo.id/peruri_sikkap/anprus/informasi"><i class="bx bx-home-alt"></i><span class="menu-title" data-i18n="">Beranda</span></a></li>
                    <li class=" nav-item"><a class="nav-link" href="https://appt.demoo.id/peruri_sikkap/anprus/dashboard"><i class="bx bx-upload"></i><span class="menu-title" data-i18n="">Form Upload</span></a></li>

                    <li class=" nav-item"><a class="nav-link" href="https://appt.demoo.id/peruri_sikkap/anprus/rekap"><i class="bx bx-dashboard"></i><span class="menu-title" data-i18n="">Dashboard</span></a></li>

                    <li class="dropdown nav-item" data-menu="dropdown"><a class="dropdown-toggle nav-link" href="#" data-toggle="dropdown"><i class="bx bx-table"></i><span>Laporan Keuangan</span></a>
                        <ul class="dropdown-menu">
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/rkap" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>RKAP</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/laba_rugi" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Laba / Rugi</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/neraca" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Neraca</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/arus_kas" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Arus Kas</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/coa" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Coa</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/prognosa" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Prognosa</a></li>
                            <!-- <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/realisasi" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Realisasi</a></li> -->
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/working_capital" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Working Capital</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/monitoring_capex" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Monitoring Capex</a></li>
                            <li data-menu=""><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/pelaporan/outstanding_pinjaman" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Outstanding Pinjaman</a></li>
                        </ul>
                    </li>
                    <!-- <li class=" nav-item"><a class="nav-link" href="https://appt.demoo.id/peruri_sikkap/anprus/rasio"><i class="bx bx-grid"></i><span class="menu-title" data-i18n="">Rasio</span></a></li> -->

                    <!-- 
                    <li class="dropdown nav-item" data-menu="dropdown"><a class="dropdown-toggle nav-link" href="#" data-toggle="dropdown"><i class="bx bxs-cog"></i><span>Config Akun</span></a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/config/akun_laba_rugi" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Laba Rugi</a>
                            <li><a class="dropdown-item align-items-center" href="https://appt.demoo.id/peruri_sikkap/anprus/config/akun_neraca" data-toggle="dropdown"><i class="bx bx-right-arrow-alt"></i>Neraca</a></li>
                        </ul>
                    </li>
                    -->

                    
                            </ul>
        </div>
        <!-- /horizontal menu content-->
    </div>
    <!-- END: Main Menu-->

    <!-- BEGIN: Content-->
    <div class="app-content content">
        <div class="content-overlay"></div>
        <div class="content-wrapper">
            <div class="content-header row">
                <div class="content-header-left col-12 mb-2 mt-1">
                    <div class="row breadcrumbs-top">
                        <div class="col-12">
                            <h5 class="content-header-title float-left pr-1 mb-0">Form Upload</h5>
                            <div class="breadcrumb-wrapper col-12">
                                <ol class="breadcrumb p-0 mb-0">

                                    
                                                                            <li class="breadcrumb-item"><a href="https://appt.demoo.id/peruri_sikkap/anprus/dashboard"><i class="bx bx-home-alt"></i></a>
                                        </li>
                                    
                                    <li class="breadcrumb-item"><a onclick="return false;" href="#">Home</a>
                                    </li>
                                    <li class="breadcrumb-item active"><a onclick="return false;" href="#">Form Upload</a>
                                    </li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-body">
                <!-- Description -->
                <section id="description" class="card"></section>
<style>
    .dropzone .dz-preview {
        background: #fff !important;
    }

    .dz-message {
        margin-top: 0 !important;
        top: auto !important;
        bottom: -200px !important;
    }

    .dz-details {
        background: none !important;
        text-align: center !important;
    }

    .dropzone.dz-clickable {
        padding-bottom: 100px !important;
    }

    .dropzone.dz-started .dz-message {
        opacity: 1 !important;
    }

    .dropzone-disabled {
        cursor: no-drop;
    }

    .col-centered{
        float: none;
        margin: 0 auto;
    }

    .dz-message_disabled{
        font-size: 1.5rem;
        position: absolute;
        top: 50%;
        left: 0;
        width: 100%;
        height: 300px;
        margin-top: -30px;
        color: #5A8DEE;
        text-align: center; 
    }
</style>
                        <input type="hidden" id="tahun_upload" value="2021" />
            <input type="hidden" id="bulan_upload" value="12" />
            <div class="row">
                <div class="col-2"></div>
                <div class="col-8 text-center">
                    <h4>Upload untuk periode Desember 2021</h4>
                </div>
                <div class="col-2"></div>
            </div>
            <section class="row">
                <div class="col-12 col-md-3 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>RKAP</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="template_rkap" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-rkap" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-rkap-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload RKAP tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-rkap"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Laba Rugi</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_laba_rugi" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-laba_rugi" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-laba_rugi-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload Laba/Rugi tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-laba_rugi"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Neraca</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_neraca" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-neraca" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-neraca-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload NERACA tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-neraca"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Arus Kas</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_arus_kas" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-arus_kas" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-arus_kas-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload ARUS KAS tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-arus_kas"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="row">
                <div class="col-12 col-md-4 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>COA</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_coa" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-coa" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-coa-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload COA tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-coa"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- <div class="col-12 col-md-3 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Resiprokal</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="template_resiprokal" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-resiprokal" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-resiprokal-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload RESIPROKAL tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-resiprokal"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
                <div class="col-12 col-md-4 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>CALK</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="calk" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-calk" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-calk-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload CALK tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-calk"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-4 col-xs-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Prognosa</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="prognosa" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-prognosa" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-prognosa-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload Prognosa tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-prognosa"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="row">
                <!-- <div class="col-2"></div> -->
                <div class="col-12">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Resiprokal</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="template_resiprokal" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-resiprokal" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-resiprokal-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload RESIPROKAL tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-resiprokal"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- <div class="col-2"></div> -->
            </section>
            <section class="row">
                <div class="col-12 col-md-4 col-xs-12 col-centered">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Working Capital</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_working_capex" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-working_capital" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-working_capital-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload Working Capital tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-working_capital"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-4 col-xs-12 col-centered">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Monitoring CAPEX</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_monitoring_capex" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-monitoring_capex" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-monitoring_capex-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload Monitoring Capex tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-monitoring_capex"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-4 col-xs-12 col-centered">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <h4>Outstanding Pinjaman</h4>
                                <div style="position: absolute;top:5px;right: 5px;">
                                    <button data-type="akun_outstanding" title="download template" type="button" class="download_template btn btn-icon rounded-circle btn-light-secondary">
                                        <i class="bx bxs-download"></i>
                                    </button>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header">
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    <div class="dropzone dropzone-area" id="dropzone-outstanding_pinjaman" style="display: none;">
                                                        <div class="dz-message">
                                                        Pilih file upload                                                        </div>
                                                    </div>

                                                    <div class="dropzone dropzone-disabled" id="dropzone-outstanding_pinjaman-disabled">
                                                        <div class="dz-message_disabled">
                                                            <div style="">
                                                                <i style="font-size: 4rem !important;" class="bx bx-x-circle"></i>
                                                            </div>
                                                            Upload Outstanding Pinjamanan tidak diijinkan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: small; text-align: center;" id="time_upload-outstanding_pinjaman"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
<!-- modal -->
<!--BorderLess Modal Modal -->
<div class="modal fade text-left modal-borderless" id="preview_file" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Preview file</h3>
                <span class="file_name modal-title"></span>
                <button type="button" class="close rounded-pill" data-dismiss="modal" aria-label="Close">
                    <i class="bx bx-x"></i>
                </button>
            </div>
            <div class="modal-body">
                <iframe class="frame_" width="100%" height="500" frameborder="0" scrolling="no" src=""></iframe>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-light-primary" data-dismiss="modal">
                    <i class="bx bx-x d-block d-sm-none"></i>
                    <span class="d-none d-sm-block">Close</span>
                </button>
            </div>
        </div>
    </div>
</div>
                </section>
                <!--/ Description -->


            </div>
        </div>
    </div>
    <!-- END: Content-->

    <div class="sidenav-overlay"></div>
    <div class="drag-target"></div>
    <div class="modal fade text-left" id="modal-password" tabindex="-1" role="dialog" aria-labelledby="myModalLabel150" aria-hidden="true">
        <form id="form-password" method="POST">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header bg-dark white">
                        <span class="modal-title" id="myModalLabel150">Ubah Password</span>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <i class="bx bx-x"></i>
                        </button>
                    </div>
                    <div class="modal-body row">
                        <fieldset class="col-md-12">
                            <label for="">Kata Sandi Lama</label>
                            <input type="password" class="form-control" name="old_password" placeholder="Masukkan Kata Sandi Lama" required>
                        </fieldset>
                        <fieldset class="col-md-12">
                            <label for="">Kata Sandi Baru</label>
                            <input type="password" class="form-control" name="password" id="password" placeholder="Masukkan Kata Sandi Baru" required>
                        </fieldset>
                        <fieldset class="col-md-12">
                            <label for="">Kata Sandi Baru (Ulangi)</label>
                            <input type="password" class="form-control" name="password_confirm" id="password_confirm" placeholder="Masukkan Kata Sandi Baru (Ulangi)" required>
                        </fieldset>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light-secondary" data-dismiss="modal">
                            <i class="bx bx-x d-block d-sm-none"></i>
                            <span class="d-none d-sm-block">Close</span>
                        </button>
                        <button type="submit" class="btn btn-light-primary"><i class="bx bx-x d-block d-sm-none"></i> <span class="d-none d-sm-block">Simpan</span></button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <!-- BEGIN: Footer-->
    <footer class="footer footer-static footer-light">
        <p class="clearfix mb-0"><span class="float-left d-inline-block">2019 &copy; PIXINVENT</span><span class="float-right d-sm-inline-block d-none">Crafted with<i class="bx bxs-heart pink mx-50 font-small-3"></i>by<a class="text-uppercase" href="https://1.envato.market/pixinvent_portfolio" target="_blank">Pixinvent</a></span>
            <button class="btn btn-primary btn-icon scroll-top" type="button"><i class="bx bx-up-arrow-alt"></i></button>
        </p>
    </footer>
    <!-- END: Footer-->


    <!-- BEGIN: Vendor JS-->
    <script>
        function getMeta(metaName) {
            const metas = document.getElementsByTagName('meta');

            for (let i = 0; i < metas.length; i++) {
                if (metas[i].getAttribute('name') === metaName) {
                    return metas[i].getAttribute('content');
                }
            }

            return '';
        }

        const BASE_URL = getMeta('url');
        const ACCESS_TOKEN = getMeta('access_token');
        const PEGAWAI_ID = getMeta('pegawai_id');
        const JABATAN_ID = getMeta('jabatan_id');
        const BULAN_SESS = getMeta('bulan_SESS');
        const TAHUN_SESS = getMeta('tahun_SESS');

        const dtLang = {
            processing: "Memuat data",
            paginate: {
                first: '<<',
                previous: '<',
                next: '>',
                last: '>>'
            },
            lengthMenu: 'Menampilkan _MENU_ data',
            search: 'Pencarian: ',
            info: 'Menampilkan _START_ ke _END_ dari _TOTAL_ data',
            infoEmpty: 'Kosong',
            infoFiltered: '(Tersaring dari _MAX_ data)',
            emptyTable: 'Data kosong'
        };
    </script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/vendors.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.tools.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.defaults.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/forms/select/select2.full.min.js"></script>

    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/datatables.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/dataTables.bootstrap4.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/dataTables.buttons.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/buttons.html5.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/buttons.print.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/buttons.bootstrap.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/pdfmake.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/tables/datatable/vfs_fonts.js"></script>
    <!-- BEGIN Vendor JS-->

    <!-- BEGIN: Page Vendor JS-->
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/ui/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

    
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/extensions/sweetalert2.all.min.js"></script>

    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/picker.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/picker.date.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/picker.time.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/legacy.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/daterange/moment.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/daterange/daterangepicker.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/forms/select/select2.full.min.js"></script>
    <script>
        $("#periode_tahun").change(function() {
            $("#periode_bulan").val('');
        });

        $("#periode_bulan").change(function() {
            var datat_semester = $(this).val();
            $.post(BASE_URL + 'login/change_periode', {
                periode_tahun : $("#periode_tahun").val(),
                periode_bulan : $("#periode_bulan").val()
            }).done((res) => {
                var res = JSON.parse(res)
                if (res.status) {
                    toastr.success(
                        'Berhasil Ganti Periode !',
                        'Silakan tunggu halaman akan dimuat ulang',
                        {
                            timeOut: 1000,
                            fadeOut: 1000,
                            onHidden: function () {
                                window.location.reload();
                            }
                        }
                    );
                } else {
                    toastr.error(res.data.message);
                }
            })
        });

        function showModalPassword() {
            $('#modal-password').modal('show')
        }

        $('#form-password').on('submit', function(e) {
            e.preventDefault();

            var dataForm = new FormData(this)
            dataForm.append('access_token', ACCESS_TOKEN)

            if ($('#password').val() != $('#password_confirm').val()) {
                Swal.fire('Gagal', 'Kata sandi baru tidak sama dengan kata sandi baru (ulangi)', 'warning');
            } else {
                $.ajax({
                    url: BASE_URL + 'login/aksi_password',
                    type: 'POST',
                    data: dataForm,
                    dataType    : "JSON",
                    processData : false,
                    contentType : false,
                    cache       : false,
                    async       : false,
                }).done((res) => {
                    if (res.status == 'success') {
                        $('#modal-password').modal('hide');
                        $('#form-password')[0].reset();
                        Swal.fire('Berhasil!', 'Berhasil menyimpan kata sandi baru', 'success');
                    } else {
                        Swal.fire('Gagal!', 'Kata sandi lama tidak sesuai !', 'error');
                    }
                })
            }
        });
    </script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/ui/jquery.sticky.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/ui/prism.min.js"></script>
    <!-- END: Page Vendor JS-->

    <!-- BEGIN: Theme JS-->
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/js/scripts/configs/horizontal-menu.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/js/core/app-menu.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/js/core/app.js"></script>
    <!-- END: Theme JS-->

    <!-- BEGIN: Page JS-->
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/js/scripts/pages/dashboard-ecommerce.js"></script>

    
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/ui/jquery.sticky.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/picker.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/picker.date.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/pickadate/picker.time.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/daterange/moment.min.js"></script>
    <script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/pickers/daterange/daterangepicker.js"></script>

    <link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/css/file-uploaders/dropzone.min.css">
<link rel="stylesheet" type="text/css" href="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/css/plugins/file-uploaders/dropzone.css">

<script src="https://appt.demoo.id/peruri_sikkap/assets/base_template/app-assets/vendors/js/extensions/dropzone.min.js"></script>

<script>
    $(document).ready(function(){
        update_available();
    })
</script>

<script>
    var lock = '0';
    var upload = '1';
    var upload_bulan = $('#bulan_upload').val();
    var upload_tahun = $('#tahun_upload').val();

    let available_rkap = true;
    let available_laba_rugi = false;
    let available_neraca = false;
    let available_arus_kas = false;
    let available_coa = false;
    let available_resiprokal = false;
    let available_calk = false;
    let available_working_capital = false;
    let available_monitoring_capex = false;
    let available_outstanding_pinjaman = false;

    Dropzone.autoDiscover = false;
</script>

<!-- RKAP -->
<script>
    let file_upload_rkap = new Dropzone("#dropzone-rkap", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_rkap = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_rkap', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-rkap').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_rkap.options.addedfile.call(myDropzone_rkap, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                    console.log(lock + ' ' + upload);
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-rkap').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_rkap.options.addedfile.call(myDropzone_rkap, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_rkap',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_rkap',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-rkap').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    // dz-preview dz-file-preview
    $('#dropzone-rkap').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_rkap';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Laba / Rugi -->
<script>
    let file_upload_laba_rugi = new Dropzone("#dropzone-laba_rugi", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_laba_rugi = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_laba_rugi', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-laba_rugi').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_laba_rugi.options.addedfile.call(myDropzone_laba_rugi, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                console.log(response);
                if (response.status == 'success') {
                    $('#time_upload-laba_rugi').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_laba_rugi.options.addedfile.call(myDropzone_laba_rugi, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_laba_rugi',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_laba_rugi',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-laba_rugi').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-laba_rugi').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_laba_rugi';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Neraca -->
<script>
    let file_upload_neraca = new Dropzone("#dropzone-neraca", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_neraca = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_neraca', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-neraca').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_neraca.options.addedfile.call(myDropzone_neraca, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-neraca').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_neraca.options.addedfile.call(myDropzone_neraca, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_neraca',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_neraca',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-neraca').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-neraca').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_neraca';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- CALK -->
<script>
    let file_upload_calk = new Dropzone("#dropzone-calk", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_calk = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_calk', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-calk').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_calk.options.addedfile.call(myDropzone_calk, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                $('#time_upload-calk').html('Uploaded at : ' + response.data.uploaded_at);
                if (response.status == 'success') {
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_calk.options.addedfile.call(myDropzone_calk, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_calk',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_calk',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-calk').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-calk').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_calk';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Prognosa -->
<script>
    let file_upload_prognosa = new Dropzone("#dropzone-prognosa", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_prognosa = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_prognosa', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-prognosa').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_prognosa.options.addedfile.call(myDropzone_prognosa, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-prognosa').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_prognosa.options.addedfile.call(myDropzone_prognosa, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_prognosa',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_prognosa',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-prognosa').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-prognosa').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_prognosa';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Resiprokal -->
<script>
    let file_upload_resiprokal = new Dropzone("#dropzone-resiprokal", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_resiprokal = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_resiprokal', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-resiprokal').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_resiprokal.options.addedfile.call(myDropzone_resiprokal, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                console.log(response);
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-resiprokal').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    // file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_resiprokal.options.addedfile.call(myDropzone_resiprokal, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_resiprokal',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_resiprokal',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-resiprokal').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-resiprokal').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_resiprokal';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Working Capital -->
<script>
    let file_upload_working_capital = new Dropzone("#dropzone-working_capital", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_working_capital = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_working_capital', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-working_capital').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_working_capital.options.addedfile.call(myDropzone_working_capital, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-working_capital').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_working_capital.options.addedfile.call(myDropzone_working_capital, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_working_capital',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_working_capital',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-working_capital').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-working_capital').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_working_capital';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Monitoring Capex -->
<script>
    let file_upload_monitoring_capex = new Dropzone("#dropzone-monitoring_capex", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_monitoring_capex = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_monitoring_capex', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-monitoring_capex').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_monitoring_capex.options.addedfile.call(myDropzone_monitoring_capex, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-monitoring_capex').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_monitoring_capex.options.addedfile.call(myDropzone_monitoring_capex, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_monitoring_capex',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_monitoring_capex',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-monitoring_capex').html('');
                                update_available();
                    
                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-monitoring_capex').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_monitoring_capex';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Outstanding Pinjaman -->
<script>
    let file_upload_outstanding_pinjaman = new Dropzone("#dropzone-outstanding_pinjaman", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_outstanding_pinjaman = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_outstanding_pinjaman', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-outstanding_pinjaman').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_outstanding_pinjaman.options.addedfile.call(myDropzone_outstanding_pinjaman, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-outstanding_pinjaman').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_outstanding_pinjaman.options.addedfile.call(myDropzone_outstanding_pinjaman, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_outstanding_pinjaman',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            console.log(file.name);
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_outstanding_pinjaman',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-outstanding_pinjaman').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-outstanding_pinjaman').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_outstanding_pinjaman';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- COA -->
<script>
    let file_upload_coa = new Dropzone("#dropzone-coa", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_coa = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_coa', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-coa').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_coa.options.addedfile.call(myDropzone_coa, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-coa').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_coa.options.addedfile.call(myDropzone_coa, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_coa',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_coa',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-coa').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_coa';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- Arus Kas -->
<script>
    let file_upload_arus_kas = new Dropzone("#dropzone-arus_kas", {
        addRemoveLinks: true,
        init: function() {
            myDropzone_arus_kas = this;

            $.get(BASE_URL + 'anprus/dashboard/get_berkas_arus_kas', {bulan : upload_bulan, tahun : upload_tahun}, function(data) {
                $.each(data, function(key, value) {
                    $('#time_upload-arus_kas').html('Uploaded at : ' + value.uploaded_at);
                    var mockFile = {
                        name: value.name,
                        size: value.size
                    };
                    myDropzone_arus_kas.options.addedfile.call(myDropzone_arus_kas, mockFile);
                    // myDropzone_1.options.thumbnail.call(myDropzone_1, mockFile, BASE_URL + "uploads/berkas_neraca/" + value.name);
                });
                if (lock == '1' && upload == false) {
                    $('.dz-remove').attr('style','pointer-events:none');
                }
            });

            this.on("success", function(file, response) {
                
                var response = JSON.parse(response);
                if (response.status == 'success') {
                    $('#time_upload-arus_kas').html('Uploaded at : ' + response.data.uploaded_at);
                    update_available();

                    file.previewElement.remove();
                    var mockFile = {
                        name: response.data.name,
                        size: response.data.size
                    };
                    myDropzone_arus_kas.options.addedfile.call(myDropzone_arus_kas, mockFile);
                } else {
                    file.previewElement.remove();
                    toastr.error(response.msg, {
                        timeOut: 3000,
                        fadeOut: 1000
                    });
                }
            });

        },
        url: BASE_URL + 'anprus/dashboard/upload_arus_kas',
        maxFilesize: 5,
        method: "POST",
        data : {bulan : upload_bulan, tahun : upload_tahun},
        paramName: "file_excel",
        dictInvalidFileType: "Type file ini tidak dizinkan",
        addRemoveLinks: true,
        acceptedFiles: '.xls,.xlsx',
        removedfile: function(file) {
            var file_ = file.name;
            Swal.fire({
                title: 'Hapus Data ?',
                text: "Data akan dihapus dari sistem",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                cancelButtonText: 'Batal',
                reverseButtons: true
            }).then((result) => {
                if (result.value) {
                    // e.preventDefault();
                    $.ajax({
                        url: BASE_URL + 'anprus/dashboard/delete_arus_kas',
                        type: "POST",
                        data: {
                            file: file_
                        },
                        dataType: "JSON",
                        beforeSend: function() {
                            // console.log('sedang menghapus');
                        },
                        complete: function() {
                            // console.log('Berhasil');
                        },
                        success: function(data) {
                            if (data.status == 'success') {
                                $('#time_upload-arus_kas').html('');
                                update_available();

                                file.previewElement.remove();
                                toastr.success('Data berhasil dihapus', {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            } else {
                                toastr.error(data.msg, {
                                    timeOut: 2000,
                                    fadeOut: 2000
                                });
                            }
                        },
                    });
                } else {
                    return false;
                }
            })
        },
    });

    $('#dropzone-arus_kas').on('click', '.dz-preview.dz-file-preview', function(e) {
        var file = $(this).children().children().children('span').html();
        $('#preview_file .file_name').html(file);
        var url = BASE_URL + 'anprus/dashboard/cek_lokasi/berkas_arus_kas';
        $.ajax({
            type: "POST",
            url: url,
            data: {
                file: file
            },
            dataType: "JSON",
            success: function(data) {
                if (data.status == 'success') {
                    console.log(data.file_lokasi);
                    var embed = "https://view.officeapps.live.com/op/embed.aspx?src=" + data.file_lokasi;
                    $('#preview_file .frame_').attr('src', embed);
                    $('#preview_file').modal('show')
                }
            }
        });
    });
</script>

<!-- download link -->
<script>
    var link = BASE_URL + 'anprus/dashboard/download/'

    $('.download_template').on('click', function(e) {
        e.preventDefault();
        var type = $(this).data('type');
        location.href = link + type;
    });
</script>

<!-- ganti bulan -->
<script>
    $.get(BASE_URL + 'ref/ganti_bulan', {}).done((res) => {
        var res = JSON.parse(res)
        if (res.success) {
            Swal.fire({
                title: "Berhasil!",
                text: res.msg,
                type: "success",
            }).then(function() {
                location.reload();
            });
        } else {
            alert("Error!!");
        }
    })
</script>

<!-- Function -->
<script>
function update_available(){
    $.ajax({
        url:"https://appt.demoo.id/peruri_sikkap/anprus/dashboard/cek_available",
        type: "GET",
        dataType: "JSON",
        success: function(res){
            // console.log(res);
            if(res.status){
                available_rkap = true;
                if(res.data.rkap){
                    available_laba_rugi = true;
                    available_neraca = true;
                    if(res.data.laba_rugi && res.data.neraca){
                        available_arus_kas = true;
                        available_coa = true;
                        available_resiprokal = true;
                        available_calk = true;
                        available_prognosa = true;

                        if(res.data.arus_kas && res.data.coa && res.data.resiprokal && res.data.calk){
                            available_working_capital = true;
                            available_monitoring_capex = true;
                            available_outstanding_pinjaman = true;
                        } else {
                            available_working_capital = false;
                            available_monitoring_capex = false;
                            available_outstanding_pinjaman = false;
                        }
                    } else {
                        available_arus_kas = false;
                        available_coa = false;
                        available_resiprokal = false;
                        available_calk = false;
                        available_prognosa = false;
                        available_working_capital = false;
                        available_monitoring_capex = false;
                        available_outstanding_pinjaman = false;
                    }
                } else {
                    available_laba_rugi = false;
                    available_neraca = false;
                    available_arus_kas = false;
                    available_coa = false;
                    available_resiprokal = false;
                    available_calk = false;
                    available_prognosa = false;
                    available_working_capital = false;
                    available_monitoring_capex = false;
                    available_outstanding_pinjaman = false;
                }
            }   
            
            show_dropzone(available_rkap, "available_rkap");
            show_dropzone(available_laba_rugi, "available_laba_rugi");
            show_dropzone(available_neraca, "available_neraca");
            show_dropzone(available_arus_kas, "available_arus_kas");
            show_dropzone(available_coa, "available_coa");
            show_dropzone(available_resiprokal, "available_resiprokal");
            show_dropzone(available_calk, "available_calk");
            show_dropzone(available_prognosa, "available_prognosa");
            show_dropzone(available_working_capital, "available_working_capital");
            show_dropzone(available_monitoring_capex, "available_monitoring_capex");
            show_dropzone(available_outstanding_pinjaman, "available_outstanding_pinjaman");
        },
        error: function(){

        }
    });
}

function show_dropzone(variable, string){
    berkas = string.split("available_")[1];
    if(variable){
        $('#dropzone-'+berkas).show();
        $('#dropzone-'+berkas+'-disabled').hide();
    } else {
        $('#dropzone-'+berkas).hide();
        $('#dropzone-'+berkas+'-disabled').show();
    }
}

</script>

<script>
    if (lock == '1' && upload == false) {
        file_upload_rkap.disable();
        file_upload_laba_rugi.disable();
        file_upload_neraca.disable();
        file_upload_calk.disable();
        file_upload_prognosa.disable();
        file_upload_resiprokal.disable();
        file_upload_working_capital.disable();
        file_upload_monitoring_capex.disable();
        file_upload_outstanding_pinjaman.disable();
        file_upload_coa.disable();
        file_upload_arus_kas.disable();
        // file_upload_laba_rugi.disable();
        // file_upload_2.disable();
        // file_upload_3.disable();
        // file_upload_4.disable();
        $(".dz-message").css("color", "red");
        $('.dz-remove').hide();
        console.log(lock);
    }
    // console.log(lock);
    // console.log(upload);
</script>        <!-- END: Page JS-->

</body>
<!-- END: Body-->

</html>
